rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {

      match /images/{imageId}{
        allow read: if true;
        allow create: if request.auth != null 
        && request.resource.data.size() == 6
        && request.resource.data.keys().hasAll(['id', 'name', 'name_insensitive', 'search_terms', 'url', 'created_at']);
        
        allow delete: if request.auth != null && resource.data.id == imageId;
      }
    }
  }
}